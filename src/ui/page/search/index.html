<Page title="Search" :_csrf>
    <div class="container container--main">
        <div class="grid-row ">
            <div class="column-full ">
                <h1 class="heading-xlarge heading heading--page-heading ">
                    Search results
                </h1>
                <div class="search-box u-space-b30">
                    <form name="searchLearning" method="get" action="/search">
                        <div class="form-group search-box__group">
                            <label class="visuallyhidden">Search all available learning</label>
                            <input class="form-control search-box__input" id="q" type="search" name="q" value="{{ query }}" placeholder="Search CSL">
                            <button type="submit" class="search-box__submit">Search</button>
                        </div>
                    </form>
                </div>
                {{#if searchResults && searchResults.suggestion}}
                <span class="search__suggestion">Did you mean
                    <a href="/search?q={{searchResults.suggestion}}">{{searchResults.suggestion}}</a>
                </span>
                {{/if}} {{#if searchResults && query}}
                <p class="lede">There were
                        <strong class="lpg-search-amount">{{searchResults.totalResults ? currentReq.__n('%s result', searchResults.totalResults) : 'no results '}}</strong>
                    for
                    <strong class="lpg-search-query">{{ query }}</strong>
                </p>
                {{/if}}
            </div>
        </div>

        <div class="grid-row ">
            <div class="column-full ">
                <div class="resources">
                    {{#if searchResults.results.length}}
                        {{#each searchResults.results as course}}
                            <DisciteCourse course={{course}} modifier="search" />
                        {{/each}}
                    {{/if}}
                </div>
            </div>
        </div>
        {{#if searchResults.totalResults !== 0}}
        <div class="pager">
            <div class="pager__controls">
                {{#if searchResults.page > 0}}
                <a class="pager__prev" href="/search?q={{query}}&s={{searchResults.size}}&p={{searchResults.page - 1}}">Prev</a>
                {{/if}}

                {{#if Math.ceil(searchResults.totalResults/searchResults.size) != 1}}
                <ul class="pager__list">
                    {{#each range(Math.ceil(searchResults.totalResults/searchResults.size)) as x}}
                    <li>
                        {{#if x === searchResults.page}}
                        <span>{{x+1}}</span>
                        {{else}}
                        <a href="/search?q={{query}}&s={{searchResults.size}}&p={{x}}">{{x+1}}</a>
                        {{/if}}
                    </li>
                    {{/each}}
                </ul>
                {{/if}}

                {{#if searchResults.page != (Math.ceil(searchResults.totalResults/searchResults.size)-1)}}
                <a class="pager__next" href="/search?q={{query}}&s={{searchResults.size}}&p={{searchResults.page + 1}}">Next</a>
                {{/if}}
            </div>
            <div class="pager__summary">Showing {{((searchResults.page*searchResults.size)+1)}} â€“ {{((searchResults.page*searchResults.size)+searchResults.results.length)}} of {{searchResults.totalResults}} items</div>
        </div>
        {{/if}}
    </div>
</Page>
