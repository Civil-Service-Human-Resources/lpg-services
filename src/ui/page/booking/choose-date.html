<Page title="Select course date" {_csrf}>
    <div class="container">
        <div class="grid-row">
            <div class="column-full">
                <h1 class="heading-xlarge">
                    <span class="heading-secondary">Booking a course</span>
                    Select course date
                </h1>
            </div>
        </div>
        <div class="grid-row">
            <div class="column-full">

                {#if errorTitle}
                <div class="error-summary" role="alert" aria-labelledby="error-summary-heading" tabindex="-1">
                    <h2 class="heading-medium error-summary-heading" id="error-summary-heading">
                        {$i18n(errorTitle)}
                    </h2>
                    <p>
                        {$i18n(errorMessage)}
                    </p>
                </div>
                {/if} {#if events && events.length}
                <p class="lede">
                    Check on which dates you can attend and in which locations, then select a suitable option below.
                </p>
                {selectedEventId}
                <h2 class="heading-small">{ module.title || course.title }</h2>
                <form autocomplete="nope" method="post">
                    <div class="div-table div-table--5 lpg-date-table">
                        <div class="div-table__row u-clearfix">
                            <div class="div-table__th">Date</div>
                            <div class="div-table__th">Time</div>
                            <div class="div-table__th">Location</div>
                            <div class="div-table__th">Availability</div>
                            <div class="div-table__th"><span class="visuallyhidden">Action</span></div>
                        </div>
                        {#each events as event, index}
                            <div class="div-table__row u-clearfix lpg-date-row">
                                <div class="div-table__cell lpg-date">{$datetime.formatDate(event.date)}</div>

                                <div class="div-table__cell">
                                    {$datetime.formatTime(event.date, true)}
                                    { module.duration ? 'to ' + $datetime.addSeconds(event.date, module.duration, true) : ''}

                                </div>
                                <div class="div-table__cell">{event.location}</div>
                                <div class="div-table__cell">Fully booked {event.capacity}</div>
                                <div class="div-table__cell div-table__cell--action">
                                    <div class="multiple-choice multiple-choice--booking">
                                        <input id="radio-{event.id}"
                                        type="radio" name="selected-date"
                                        class="multiple-choice__input"
                                        checked="{selectedEventId === event.id ? 'checked' : ''}"
                                        disabled="{selectedDate ? 'disabled' : ''}"
                                        value="{event.id}"
                                        >
                                        <label for="radio-{event.id}" class="multiple-choice__label">
                                            <span class="multiple-choice__spanner">
                                                <span class="visuallyhidden">{$datetime.formatDate(event.date)}, {event.location}</span>
                                            </span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        {/each}
                    </div>
                    {#if showAccessibility}
                         <AccessibilityOptions/>
                    {:else}
                        <button class="link button--link" type="submit" formaction="{$req.url}?accessibility=true">
                            Accessibility and reasonable adjustments
                        </button>
                    {/if}



                    <div class="panel panel-border-wide">
                        <p>
                            You are confirming that you have approval to book this course.
                        </p>
                    </div>
                    <input type="hidden" name="_csrf" value="{_csrf}">
                    <input type="submit" class="button" value="Continue" formaction="/book/{course.id}/{module.id}/choose-date">
                </form>



                {:else}
                <p>Unfortunately this course is not currently available.</p>
                {/if}
            </div>
        </div>
    </div>

</Page>


<script>
	import Page from '../../component/Page.html'
	import AccessibilityOptions from '../../component/AccessibilityOptions.html'

	export default {
		data() {
			return {
			}
		},

		components: {
			Page,
			AccessibilityOptions,
		}
	}
</script>